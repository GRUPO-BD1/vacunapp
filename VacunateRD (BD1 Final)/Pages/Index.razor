@page "/"
@using VacunateRD__BD1_Final_.Data
@inject DBServices objDBServices
@inject NavigationManager NavigationManager


<h1>Buscar personas vacunadas</h1>

<div class="form-group">
    <label for="Name" class="control-label">Identificación</label>
    <input for="Name" class="form-control" @bind="@identificacion1" />
</div>

<input type="button" class="btn btn-primary" @onclick="@BuscarPorId" value="Buscar" />

@if (PersonaHistorial == null)
{
    <p><em>Esperando búsqueda</em></p>
}
else 
{
    <table class="table">
        <thead>
            <tr>
                <th>Nombres</th>
                <th>Apellidos</th>
                <th>Profesión</th>
                <th>Fecha Nacimiento</th>
                <th>Fase</th>
                <th>Centro</th>
                <th>Número de Mesa</th>
                <th>Dosis Correspondiente</th>
                <th>Fecha</th>
                <th>Lote</th>
                <th>Vacuna</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var temp in PersonaHistorial)
            {
            <tr>
                <td>@temp.Nombres</td>
                <td>@temp.Apelllidos</td>
                <td>@temp.Profesion</td>
                <td>@temp.Fechanacimiento</td>
                <td>@temp.CodigoFase</td>
                <td>@temp.Centro</td>
                <td>@temp.NumMesa</td>
                <td>@temp.DosisCorrespondiente</td>
                <td>@temp.Fechaproporcionada</td>
                <td>@temp.IdLote</td>
                <td>@temp.NombreVacuna</td>
                <td>
                    <a class="nav-link" href="EditCustomer/">
                        <span class="oi oi-pencil" aria-hidden="true"></span> Vacunar
                    </a>
                </td>
            </tr>
            }
        </tbody>
    </table>
}

@code {
        List<PersonaVacunacion> PersonaHistorial;
    public string identificacion1 { get; set; }

    protected void BuscarPorId()
    {
        if (identificacion1 != null)
        {
            DBServices db = new DBServices();
            PersonaHistorial = db.GetPersonaDataByIdentificacion(identificacion1).ToList();
        }
    }
    /*
protected override async Task OnInitializedAsync()
{
    DBServices db = new DBServices();
    PersonaHistorial = await Task.Run(() => db.GetPersonaDataByIdentificacion(identificacion1));
}*/
}
